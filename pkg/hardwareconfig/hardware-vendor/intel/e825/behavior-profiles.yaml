# Behavior profiles for Intel E825 hardware
# These templates define default behavior configurations for different clock types
# Template variables: {subsystem}, {ptpInputPin}, {interface}
# Hardware-specific pins (SDP2, SDP0) are hardcoded in the template

behaviorProfiles:
  t-bc:
    # Pin role mappings - defines which pins serve which roles
    pinRoles:
      gnssInputPin: GNSS_1PPS_IN  # DPLL pin used for GNSS input (that should be disabled for T-BC)
      ptpInputPin: GNR-D_SDP0  # DPLL pin used for PTP input
    
    # Source template - will be instantiated with resolved variables
    sources:
      - name: PTP
        sourceType: ptpTimeReceiver
        subsystem: "{subsystem}"  # Will be resolved to subsystem name
        boardLabel: "{ptpInputPin}"  # Will be resolved from pinRoles
        # ptpTimeReceivers will be derived from ptpconfig
    
    # Condition templates - will be instantiated with resolved variables
    conditions:
      - name: "Initialize T-BC"
        triggers:
          - conditionType: init
            sourceName: PTP
        desiredStates:
          - dpll:
              subsystem: "{subsystem}"
              boardLabel: "{gnssInputPin}"
              eec:
                state: disconnected
              pps:
                state: disconnected
          - ptpPin:
              name: SDP2
              func: Disabled
              chan: 0
              sourceName: PTP
          - ptpPin:
              name: SDP0
              func: Disabled
              chan: 0
              sourceName: PTP
      
      - name: "PTP Source Locked"
        triggers:
          - conditionType: locked
            sourceName: PTP
        desiredStates:
          - ptpPin:
              name: SDP2
              func: TX
              chan: 2
              sourceName: PTP
          - ptpPin:
              name: SDP0
              func: TX
              chan: 1
              sourceName: PTP
          - ptpPeriod:
              index: 1
              period:
                sec: 1
                nsec: 0
              sourceName: PTP
          - ptpPeriod:
              index: 2
              period:
                sec: 0
                nsec: 1000000
              sourceName: PTP
          - dpll:
              subsystem: "{subsystem}"
              boardLabel: "{ptpInputPin}"
              eec:
                state: disconnected
              pps:
                state: selectable
      
      - name: "PTP Source Lost - Leader Holdover"
        triggers:
          - conditionType: lost
            sourceName: PTP
        desiredStates:
          - ptpPin:
              name: SDP0
              func: Disabled
              chan: 0
              sourceName: PTP
          - ptpPin:
              name: SDP2
              func: Disabled
              chan: 0
              sourceName: PTP

